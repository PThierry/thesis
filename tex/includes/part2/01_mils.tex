%%
%%
%% hardware_impacts.tex for thesis in /doctorat/these/tex
%%
%% Made by Philippe THIERRY
%% Login   <Philippe THIERRYreseau-libre.net>
%%
%% Started on  Fri Mar 12 16:36:41 2010 Philippe THIERRY
%% Last update Mon Aug 30 17:00:21 2010 Philippe THIERRY

\chapter{De la définition d'une architecture logicielle pour le MLS orientée traitement de flux}
\doMinitoc

\section{A propos du principe de passerelle de traitement de flux MultiLevel Security}
\label{sec:mls_gw_principle}

\paragraph{}
Afin de répondre à la problématique décrite en \ref{sec:problematique}, il est
nécessaire de définir une solution répondant au besoin de sécurité
multi-niveaux (MLS), impliquant un mécanisme assurant une étanchéité des
données à différents niveaux:
\begin{itemize}
  \item Les données transitant du niveau le plus élevé au niveau le plus
    faible doivent être complètement contrôlées, afin de valider que ces
    dernières peuvent être désensibilisées
  \item Le flux transitant du niveau le plus faible au niveau le plus élevé ne
    nécessite pas de filtrage en terme de contenu. Cependant, son comportement
    ne doit pas fournir d'information aux éléments émetteurs ou tout autre
    élément du niveau de sécurité le plus faible
\end{itemize}

\paragraph{}
Les mécanismes définis pour répondre au besoin de type MLS ou MILS définissent
des exigences permettant de répondre à ce besoin \FIXME{ref}.
Afin d'être compatible de ces exigences, je m'appuie sur le principe de
micro-noyau de sécurité, permettant de garantir des propriétés d'isolation. A
cela, il est nécessaire de définir une architecture logicielle complète pour
répondre à la problématique. Cette architecture est décrite dans ce chapitre.


\section{Définition des hypothèses générales}
\label{sec:mls_gw_hypothesis}

\subsection{A propos des propriétés du matériel}

\paragraph{}
La définition d'un système sécurisé implique de prendre en compte l'impact
sécuritaire du matériel. Dans le cadre de ma thèse, j'ai ciblé principalement
les propriétés que doit apporter le logiciel, et considère en conséquence des
hypothèses strictes sur le matériel.\\
Bien que ces hypothèses soient peu réalistes sur du matériel généraliste (i.e.
du marché civil), elles doivent être supportées pour assurer les propriétés de
sécurité, à défaut d'avoir intégrer un design matériel spécifique. Ces
hypothèses sont les suivantes:

\begin{hypothesis}
  {\bf conformité}: l'ensemble des contrôleurs matériels sont conformes de leur
  documentation. Ils assurent le respect des exigences documentaires et ne
  fourissent aucune propriété non documentée
\end{hypothesis}

\begin{hypothesis}
  {\bf compatibilité au temps réel}: les éléments d'interconnexion (bus,
  interconnect, etc) sont compatibles de la gestion de tâches temps réel. Ces
  derniers ne sont pas considérés dans le cadre de ma thèse comme impactant.
\end{hypothesis}

\begin{hypothesis}
  {\bf sûreté de fonctionnement}: les éléments matériels sont réputés sûrs.
  Ils ne génèrent pas de faille de sécurité de par une erreur d'architecture
  ou de comportement.
\end{hypothesis}

\paragraph{}
Bien que ces hypothèses soient considérés valide dans le cadre du matériel
considéré dans la solution, l'usage invalide volontaire de ce matériel par
le logiciel reste considéré pour les problématiques de sécurité. L'usage du
matériel comme base pour des cannaux cachés ou auxiliaires est considéré dans
le cadre de ma thèse et des solutions sont proposées pour répondre à cette
problématique.

\section{Problématiques d'architectures et choix structuraux}

\subsection{De la raison de la présence d'éléments non certifiables}
\label{sec:noncert}

\paragraph{}
La présente passerelle interconnecte des domaines de sécurité disjoints. Elle
doit donc être compatible des propriétés \ref{pro:noncontournable},
\ref{pro:evaluable}, \ref{pro:validation} et \ref{pro:inviolable}
des architectures MLS.

\paragraph{}
On a pu constater dans l'état de l'art \FIXME{ref} que les éléments logiciels
permettant de faire du traitement télécom avec valeur ajoutée ne sont pas
compatible d'une certification. De manière générale, seul l'usage d'éléments logiciels à
faible volumétrie de code permet de supporter une certification.\\

Parce que l'implémentation logicielle d'un passerelle de type télécom ne peut être certifiée en
terme de sécurité, les éléments d'implémentation de celle-ci
sont donc considérés comme ne pouvant pas être de confiance. Il devient alors
nécessaire:
\begin{itemize}
  \item de définir dans l'architecture de sécurité deux famille logicielles
$Sec$ et $Unsec$, l'une étant de confiance, l'autre non
  \item de définir des mécanismes permettant de pouvoir intégrer des éléments
    non certifiables tout en maintenant la sécurité du système
\end{itemize}

\paragraph{}
Dans un premier temps, je définit pour les familles $Sec$ et $Unsec$ les
propriétés suivantes afin d'assurer un cloisonnement strict entre ce qui est
certifiable et ce qui ne l'est pas:

\begin{property}
$Sec$ définit l'ensemble des éléments logiciels certifiables. Ces derniers
sont aptes à contrôler des éléments matériels, bien que leur comportement
puisse être audité pas un élément tiers. Ces éléments font partie de la TCB
(Trusted Computing Base), qui définit l'ensemble des éléments certifiables et
inviolables du système.
\end{property}

\begin{property}
$Unsec$ définit l'ensemble des éléments logiciels non-certifiables. Ces derniers
ne peuvent accéder directement à tout élément de configuration du matériel.
\end{property}

\begin{property}
Aucun élément logiciel ne peut être à la fois sûr et non sûr:
$$Sec \cap Unsec = \emptyset$$
\end{property}


\begin{figure}
  \label{fig:iofilter}
  \input{figures/io_filtering.tex}
  \caption{filtrage par un montieur de confiance des entrées sorties}
\end{figure}


\paragraph{}
Les éléments logiciels non certifiables doivent donc être entourés d'éléments
logiciels de confiance (appartenant au groupe $Sec$) afin de valider
l'ensemble de leurs entrées/sorties. Ainsi, la propriété \ref{pro:validation}
des architectures MLS est respectée, comme le montre la Figure
\ref{fig:iofilter}.

\subsection{A propos des moniteurs de sécurité}

\paragraph{}
Il est montré dans le chapire précédant que la présence d'éléments logiciels
non certifiables est un mal nécessaire pour permettre un certain nombre de
traitements à valeur ajoutés sur des flux télécoms. En effet, l'implémentation d'une pile
réseau certifiable étant trop couteuse, j'ai fait le choix d'intégrer de tels
logiciels, en prenant en compte le problème de non-certification associée dans
l'architecture.

\paragraph{}
Comme vu dans le Chapitre \ref{sec:noncert}, l'usage de tels logiciels peut
être considérés si des éléments certifiables extérieurs sont présents afin de
rester compatible des quatres exigences initiales des architecture MLS. Dans
la litérature (\FIXME{ref}, des éléments logiciels certifiable portant une
fonction de sécurité sont appellés moniteurs de sécurité. On appellera donc
l'ensemble de ces éléments des moniteurs de sécurité.\\
Dans le cadre de cette architecture, un grand nombre de moniteurs de sécurité
est présent. L'ensemble de ses moniteurs définit l'ensemble $Sec$. Ces
derniers permettent de répondre aux différentes exigences du MLS:
\begin{itemize}
  \item Ils valident les entrées/sorties des éléments non certifiables
  \item Ils détectent et remontent les évènements invalident auprès d'un tiers
    de confiance
  \item Ils assurent le cloisonnement entre les différents éléments logiciels
    pour assurer l'inviolabilité de l'ensemble des moniteurs de sécurité (dont
    eux-même)
\end{itemize}

\subsection{Synthèse des choix structuraux}

\paragraph{}
Dans ce chapitre, j'ai décrit les choix structuraux que j'ai fait en terme
d'architecture générale du système. J'ai définit deux familles d'entités
logicielles répondant à des exigences disjointes, et définissant les fonctions
de sécurité de base permettant de respecter les architectures MLS.\\
A partir de ces éléments, je vais définir l'architecture logicielle complète
permettant de répondre au besoin d'une passerelle multi-domaines de sécurité,
en définissant les besoins sécuritaires associés à la fonction passerelles, et
en définissant l'architecture logicielle complète permettant de répondre à ce
besoin.

%\subsection{A propos de la certification par composition}

%\paragraph{}
%\FIXME{trouver une doc à ce propos}

\section{De la définition de la réponse technique au besoin}

\subsection{Définition des données à protéger}

\paragraph{}
J'ai définit dans les Chapitres \ref{sec:mls_gw_principles} et
\ref{sec:mls_gw_hypothesis} les principes généraux qui doivent être considérés
dans le cadre de la définition d'une architecture logicielle pour le
traitement de données entre domaines de sécurité disjoints (i.e. MultiLevel
Security). À la définition de ces principes généraux, il faut maintenant
décrire plus en détail les principes structuraux nécessaires pour répondre au
besoin tel que définit dans la problématique générale. Pour cela, je m'appuie
sur les principes qui ont été définit initialement par
l'ANSSI\footnote{Agence Nationale pour la Securité des Systèmes d'Information} dans le cadre
de la méthode EBIOS\cite{hemery2007utilisation}. Cette dernière implique de définir:
\begin{itemize}
  \item Quelles sont les données à protéger
  \item Quels sont les attaques dont il faut se prémunir dans le cadre de
    cette protection
\end{itemize}
La méthode EBIOS permet ensuite de pouvoir définir un niveau de sécurisation
nécessaire et suffisant pour répondre à ce besoin.

\paragraph{}
La définition de l'architecture logicielle pour le besoin d'une passerelle
multi-domaines de sécurité nécessite donc de répondre aux interrogations suivantes:
\begin{itemize}
  \item Quels sont les données à protéger ?
  \item Quel(s) type(s) de protection la passerelle souhaite fournir sur ces
    données (confidentialité, intégrité, disponibilité) ?
  \item Quels sont les attaques impactant ses protection dans le cadre de
    cette solution ?
  \item Quels sont les fonctions de sécurité nécessaires pour se prémunir
    contre ces attaques ?
\end{itemize}

\paragraph{}
Les sections suivantes mettent en pratique les principes de la méthode EBIOS
pour mettre en adéquation une solution technique avec les besoins sécuritaires
liés à la fonction passerelle multi-domaines.

\subsubsection{De la définition des données à protéger}

\paragraph{}
Dans le cadre de ma thèse, je cherche à répondre au besoin d'une passerelle
multi-domaines de sécurité et de criticité. Ainsi, le but est de permettre de
transférer du flux de type réseau IP entre deux domaines de sécurité et de
criticité. Il en découle plusieurs exigences générale de sécurité, afin
d'assurer le maintient du cloisonnement entre les deux domaines de sécurité, à
l'exception des données volontairement transmises:

\begin{requirement}
\label{req:integrity}
Les flux transmis doivent être garantis en terme d'intégrité
\end{requirement}

\begin{requirement}
\label{req:transit}
L'action de transmission des flux ne doit pas révéler d'informations sur le domaine de
sécurité le plus haut
\end{requirement}

\begin{requirement}
\label{req:desensibilisation}
Si les flux sont transmis du domaine de sécurité le plus haut au domaine le
plus bas, ces derniers doivent contenir exclusivement des données autorisées à
être désensibilisées
\end{requirement}

\begin{requirement}
  \label{req:escape}
  Les flux doivent transiter exclusivement dans la direction initialement choisie, au
  travers des canaux logiques et physiques initialement choisis
\end{requirement}

\paragraph{}
Au travers de ces exigences, je détermine la répartition des responsabilités
sécuritaires en terme de confidentialité, intégrité et disponibilité.
\begin{itemize}
  \item La confidentialité des données est partagée entre:
    \begin{itemize}
      \item La configuration de la passerelle, qui est une donnée d'entrée de
        celle-ci donc en dehors du cadre de ma thèse. C'est cette
        configuration qui détermine quel type de flux est autorisé à transité,
        et vers quelle destination
      \item Les propriétés de cloisonnement de la passerelle, qui répondent à
        l'exigence \ref{req:escape}
    \end{itemize}
  \item L'intégrité des données est assurée par la passerelle durant le temps
    de leur transit
  \item La disponibilité n'est pas considéré dans le cadre de ma thèse
\end{itemize}

\subsection{De la définition des profils d'attaques}

\subsubsection{Généralités sur les profils d'attaques}

\paragraph{}
De la définition des Exigences \ref{req:integrity}, \ref{req:transit},
\ref{req:desensibilisation} et \ref{req:escape}, il faut dériver des exigences techniques. Pour
cela, je détermine d'abord la surface d'attaque. On appelle surface d'attaque
les éléments d'interfaces à partir desquels on considère une attaque possible.
La surface d'attaque est décomposée en trois environnements disjoints:
\begin{enumerate}
  \item Les attaques externes initiées du coté du domaine de plus haute
    sécurité. Je considère alors qu'un éléments de ce domaine cherche à faire
    sortie de l'information non autorisée vers le domaine de plus faible
    sécurité, avec ou sans l'aide d'un élément de ce dernier
  \item Les attaques externes initiées du coté du domaine de plus faible
    criticité. Je considère qu'un élément du domaine de plus faible sécurité
    cherche à récupérer de l'information sur le domaine de plus haute
    sécurité, sans l'aide d'un élément de ce dernier
  \item Les attaques internes, venant des éléments de la passerelle
    appartenant à la famille $Unsec$, telle que décrite dans la Section
    \ref{sec:noncert}, impactantes pour l'exigence \ref{req:escape}
\end{enumerate}
Les éléments de la TCB (appartement à la famille $Sec$) sont considérés comme
de confiance. En conséquence, ils ne sont pas considérés comme source
d'attaque potentielle.\\
La Figure \ref{fig:threats_surface} schématise la répartition de la surface
d'attaque sur le système englobant la passerelle multi-domaines de sécurité.

\begin{figure}
  \label{fig:threats_surface}
  \input{figures/threats_surces.tex}
  \caption{Répartition des surfaces d'attaque sur la passerelle de sécurité}
\end{figure}

\paragraph{}
À ces trois surfaces d'attaque, on associe un niveau de faisabilité de
l'attaque, qui permet de déterminer le niveau de risque, et donc l'exigence de
protection associée. Dans le cadre de ma thèse, je cherche à définir une
solution modulaire associant des éléments non certifiables à des éléments
certifiables. Les domaines extérieurs à la solution ne sont de plus
par connus initialement. Il n'est alors pas possible d'en déterminer le risque
sécuritaire associer. Pour répondre à un maximum de besoin, je considère alors le
risque élevé sur ces trois surfaces et je répond donc en terme de
contre-mesures de sécurité à l'ensemble de ses environnements.

\subsubsection{Définition des attaques et impact sur les exigences
  sécuritaires de la solution}

\paragraph{}
Cette Section décrit un certain nombre d'attaques connues impactant les
exigences de sécurité de la passerelle.\\
Le Tableau \ref{tab:threats} liste les différents types d'attaques et leur
impact sur les exigences de sécurité.

\begin{table}[h!]
\label{tab:threats}
\begin{tabular}{|l|p{10cm}|c|c|c|c|}
  \hline
\cellcolor{blue!25}Source & \cellcolor{blue!25}Attaque & \multicolumn{4}{|c|}{\cellcolor{blue!25}Exigence} \\
  \hline
  \multicolumn{2}{|c|}{ } & \ref{req:integrity} & \ref{req:transit} & \ref{req:desensibilisation} & \ref{req:escape} \\ 
  \hline
  {\it Domaine inférieur} & Étude temporelle de la vitesse de transit du flux vers le domaine supérieur & & X & & \\
  \hline
  {\it Domaine supérieur} & Émission de flux non conforme de la configuration de sécurité & & & X & \\
  \hline
  {\it Interne} & Retransmission du flux au travers d'un canal non autorisé & & & & X \\
  \hline
  {\it Interne} & Modification du contenu du flux avant retransmission & X & & & \\
  \hline
  {\it Interne} & Écoute par canal auxiliaire d'un flux transitant par un autre compartiment pour retransmission & & & & X \\
  \hline
  {\it Interne} & Communication entre deux compartiments au travers d'un canal caché & & & & X \\
  \hline
\end{tabular}
\caption{Profils d'attaques et impact sur les exigences sécuritaires}
\end{table}

\subsection{De la définition des réponses }


\subsubsection{De la définition des fonctions de sécurité qui assurent les propriétés de sécurité}
\paragraph{}

\subsection{Définition des exigences sécuritaires associées}

\paragraph{}
\index{Confidentialité}Confidentialité exigée\\
\index{Intégrité}Intégrité exigée\\
Dispo non exigée (en cas de corruption des conténaires non-sûrs), mais
éléments proactifs à intégrer

\section{Définition des moniteurs de sécurité}

\subsection{Moniteurs de sécurité pour les accès matériel à risque sécuritaire}

\paragraph{}
Moniteur de gestion du DMA et moniteur de gestion de l'ethernet

\subsection{Moniteurs de sécurité pour la vérification des données}

Moniteur de filtrage de donnée (DPI), moniteur de vérification
d'authentification de l'émetteur (non existant aujourd'hui)

\subsection{A propos d'une architecture de diode logicielle pour le transfert agnostique de donnée}

\paragraph{}
Moniteur implémenté, brevet en cours de dépôt.

\subsection{De la problématique d'exploitation des canaux auxiliaires: à propos des profils de flux}

Dernier article: émetteur périodique

\subsection{De la problématique d'exploitation des canaux auxiliaires: les caches processeur}

Article sur les caches, problématique des flush de cache (à prendre en compte
dans l'ordonnancement

\section{Moniteurs de sécurité, fonctions temps réel et environnements non sécurisables}

\subsection{De la compatibilité des moniteurs de sécurité avec le temps réel}

\paragraph{}

\section{Répartition des moniteurs en environnement multi-processeur}

\subsection{Localisation des moniteurs et des compartiments par domaines de
sécurité}

\chapter{Temps réel, assurance de Qualité de Service IP et flux à multiple criticités}

\section{Ordonnancement hierarchique et Time Division Multiplexing}

Définition du problème, besoin de sécurité

\section{Priorisation par criticité, modification de la QoS pour la sécurité
  dans les moniteurs de sécurité}

Changement de criticité: priorisation aux flux dont la QoS IP n'est pas la
plus élevée


\FIXME{exigences de criticité}:\\
La transmission des flux doit respecter les exigences temporelles du domaine
de criticité le plus haut
