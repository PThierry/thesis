%%
%%
%% hardware_impacts.tex for thesis in /doctorat/these/tex
%%
%% Made by Philippe THIERRY
%% Login   <Philippe THIERRYreseau-libre.net>
%%
%% Started on  Fri Mar 12 16:36:41 2010 Philippe THIERRY
%% Last update jeu. 10 avril 2014 10:15:00 CEST phil

\chapter{État de l'art de l'interconnexion sécurisée de domaines de sécurité hétérogènes}
\doMinitoc

\paragraph{}
{\it Il existe un certain nombre de solutions dont le but est de permettre
l'interconnexion de domaines de sécurité hétérogènes. Ces solutions répondent
plutôt à des besoins de type SI, mais ces solutions
restent un très bon point de départ dans le cadre de la définition
d'une architecture logicielle sécurisée.}

\section{Sécurisation par séparation physique des traitements}

\subsection{Interconnexion sécurisée par passerelle de type diode matérielle}
\label{sec:diodemat}

\subsubsection{Description de la solution}

\paragraph{}
Dans les systèmes militaires, les domaines de sécurité devant être
interconnectés le sont au travers de passerelles certifiées s'appuyant sur des
éléments physiques disjoints. Celles-ci assurent un transfert en sens unique de données
entre le domaine de plus basse sécurité (source des données) et le domaine de
plus haute sécurité (destination des données). La passerelle de
sécurité a deux buts :
\begin{itemize}
  \item Elle assure le transfert de données en sens unique. Aucune donnée du domaine de
    sécurité le plus élevé ne peut être transférée vers le domaine de sécurité le
    plus bas.
  \item Elle assure une opacité forte du domaine de sécurité le plus élevé d'un point de vue
    comportemental. Elle évite ainsi les canaux cachés (confer Chapitre
    \ref{subsubsec:canaux_caches}) s'appuyant sur l'étude
    du comportement du domaine de sécurité le plus élevé. Ces derniers
    permettraient en effet de remonter indirectement des données
    confidentielles vers le domaine de sécurité le plus bas.
\end{itemize}

Afin de décorréler les interfaces de la fonction diode (normalement très
simples) de l'architecture réseau de chacun des deux domaines de sécurité, la
diode s'appuie sur deux {\it guichets}.
\PhDdefinition{guichet}{Guichet}{
  On appelle guichet un équipement logiciel en charge de transcoder une
  information d'un réseau à un autre. Il peut par exemple décapsuler une
  données transmise sur un réseau IP vers un lien point à point. Un guichet
  peut posséder des propriétés complémentaires, comme la validation de la
  donnée à transmettre, ou encore le chiffrement de cette dernière.
}

Ainsi, la fonction diode ne prend plus en compte les propriétés télécom de
chacun des deux domaines et conserve une certaine simplicité d'implémentation,
comme le décrit la Figure \ref{fig:diodephy} :
\begin{itemize}
  \item Un {\it guichet bas}, en charge de récupérer les
    données potentiellement via une communication en mode connecté avec le
    domaine de plus basse sécurité pour les transférer à la fonction diode via
    un protocole spécifique.
  \item Un {\it guichet haut}, en charge de récupérer les
    données sortant de la fonction diode via un protocole spécifique et initiateur
    d'une connexion potentiellement en mode connecté avec le domaine de plus
    haute sécurité.
\end{itemize}

\begin{figure}
  \input{figures/diode_phy.tex}
  \caption{Architecture générale d'une passerelle de type diode matérielle\label{fig:diodephy}}
\end{figure}

\paragraph{}
Dans l'architecture de la diode matérielle formalisée par Philippe
Lagadec de la Direction Générale de l'Armement en 2006 \cite{sstic2006diode},
les guichets permettent d'intégrer une action humaine pour valider
le transfert de données, ainsi que pour valider leur réception.
Une telle architecture permet de garantir l'imputabilité (c'est à dire associe
un responsable, confer Définition \ref{def:imput}) du transfert de données en cas d'usage invalide de la passerelle.

\subsubsection{Avantages et limitations}

\paragraph{}
Les diodes matérielles s'appuient sur le principe de séparation protocolaire
pour limiter l'exploitation de canaux cachés utilisant des
en-têtes protocolaires comme conteneur d'information.\\
En conséquence, elles ne permettent pas d'intégrer le support d'une
criticité multiple en terme d'ordonnancement de flux. Cette gestion doit donc
être déportée au niveau du guichet haut (émetteur de la donnée). L'intervention
humaine, conséquence du besoin d'imputabilité associé au transfert de données,
est également problématique lorsque le besoin de temps réel est présent.
Comme le décrit l'auteur, la diode matérielle permet cependant d'assurer à la fois:
\begin{itemize}
\item la confidentialité des données du récepteur
\item l'intégrité et la disponibilité des données de l'émetteur
\end{itemize}

\subsection{Firewall d'interconnexion de domaines de sécurité hétérogènes}

\paragraph{}
Il existe peu de solutions permettant une interconnexion de domaines de
sécurité disjoints. C'est le cas de la solution TSF 101 \cite{tsf101} de Thales
Security, permettant de faire transiter des données entre domaines de sécurité
disjoints en fonction d'une politique de sécurité chargée dans l'équipement.

\subsubsection{Description de la solution}

\paragraph{}
La solution TSF 101 permet de faire transiter des données déclassifiées du
domaine de sécurité le plus haut au domaine de sécurité le plus bas. Pour
cela, elle s'appuie sur un critère de filtrage prédéfini et non modifiable
dans le cadre de son utilisation. La solution est certifiée par les Critères
Communs au niveau EAL 5.

\subsubsection{Avantages et limitations}

\paragraph{}
La solution permet d'interconnecter des réseaux de niveaux de sensibilité
différents. Il s'agit d'un équipement impliquant un facteur de forme (confer
Définition \ref{def:ffactor}) et des
propriétés d'architecture ne lui permettant pas d'être intégré dans des
environnements embarqués contraints. La solution ne cible pas non plus de
propriétés temps réel, et n'est pas modulaire en terme de services
logiciels, le besoin auquel cet équipement répond ne nécessitant pas ces
propriétés.

\section{Architectures MLS (MultiLevel Security) et MILS
(Multi-Independent Level of Security)}
\label{sec:mils}

\subsection{Systèmes MLS, MILS et la haute sécurité}
\label{subsec:mls}

\paragraph{}
Un système MILS (Multiple Independent Level of Security) ou MLS (MultiLevel
Security) est une architecture
de haute sécurité basée sur le principe de séparation des flux d'information
dont l'implémentation est faite dans un composant certifié. Ce dernier assure
le cloisonnement de ces flux via un mécanisme évaluable au sens du standard
international des Critères Communs \cite{cc_docs} pour un coût raisonnable.

\paragraph{}
Le mécanisme assurant le cloisonnement des différents niveaux de sécurité n'est
pas imposé. Il peut être physique (séparation complète), matériel
(implémentation d'un mécanisme matériel) ou logiciel (noyau de séparation
sécurisé, usuellement nommé {\it Secure Separation Kernel} ou SSK). Dans le
cadre de ma thèse, la solution considérée est le SSK afin d'être compatible
avec les exigences de volume, de consommation et de faible coût.

\paragraph{}
Avant les premiers travaux sur les systèmes MILS (définis par le département
de la défense américain au début des années 2000), la problématique de gestion de la
sécurité dans les systèmes automatisés était étudiée au travers de principes
de listes de contrôle d'accès. En 1973 \cite{lapadula1}, une méthode de
gestion de contrôle pour des sujets ayant accès à des objets fut définie et
démontrée mathématiquement. Il s'agit du RBAC \cite{ferraiolo1995role}.

\paragraph{}
En parallèle des travaux de Bell et LaPadula \cite{lapadula1,lapadula3},
une étude fut effectuée sur la capacité à vérifier formellement les architectures
logicielles de sécurité basées sur un noyau \cite{securedesign} ({\it "kernelized secure
systems"}). L'auteur démontre la difficulté de certifier un système où
le noyau est lui-même trop complexe. Il décrit alors le principe de
noyau de sécurité, devant être de petite taille, et pouvant être accompagné de
processus logiciels de confiance, également certifiables. Une telle
architecture permet alors d'héberger des processus non certifiables
dont le cloisonnement est assuré par le noyau. L'auteur montre que le
noyau n'est alors plus sujet d'une politique de sécurité, cette dernière
ciblant les processus logiciel qu'il porte. Plus globalement, l'auteur décrit
les premiers principes d'un système rouge-noir (confer Définition
\ref{def:rn}). Ce système est basé sur une architecture distribuée de
sous-systèmes communiquant de manière sécurisée, en
assurant que l'unique moyen de passage est maîtrisé par un élément de
confiance permettant la transmission de données noircies (confer Définition
\ref{def:domn}). Ce principe est encore utilisé aujourd'hui dans la définition
de systèmes dont l'architecture est distribuée comme la radio logicielle \cite{sdr}, où il s'associe à une
architecture de type MILS pour séparer les informations.

\paragraph{}
La définition des architectures MILS et MLS reprend ces travaux afin de définir une
nouvelle approche contrastant fortement avec les principes décrits par Bell et
LaPadula.\\
Les systèmes MILS et MLS s'appuient sur des composants ayant de fortes
propriétés de sécurité édictées par le département de la défense américain.
Ensemble, ces composant forment un système :

\begin{property}
\label{pro:noncontournable}
{\bf Non contournable}:
Un composant ne peut utiliser que le chemin de communication
qui lui est fourni par le moniteur de sécurité.
\end{property}

\begin{property}
\label{pro:evaluable}
{\bf Evaluable}:
L'ensemble des composants considérés comme de confiance doivent être évaluable
au niveau de sécurité demandé.
\end{property}

L'évaluation de ces composants doit être suffisante pour assurer le niveau de
sécurité de l'ensemble du système (i.e. les composants qui ne sont pas de
confiance ne doivent pas impacter le niveau de sécurité du système).

\begin{property}
\label{pro:validation}
{\bf Validation à chaque accès}:
Chaque accès ou message entre composants doit pouvoir être validé par un
moniteur de sécurité.
\end{property}

Le moniteur de sécurité peut être le SSK ou un processus de confiance dédié à
ce traitement.

\begin{property}
\label{pro:inviolable}
{\bf Inviolable}:
Le système assure le contrôle des accès en écriture aux moniteurs de
sécurité, à leurs données ou à leur configuration, assurant ainsi leur
intégrité.
\end{property}

\paragraph{}
Un système MultiLevel Security correspond à l'usage d'un système informatique
permettant de traiter en parallèle des données de niveaux de sécurité hétérogènes. Il
permet l'accès simultané à des utilisateurs ayant des niveaux d'accréditation
et de droits d'en connaître (confer Définition \ref{def:droitden}) différents, tout en garantissant un cloisonnement
strict entre ces différents utilisateurs. La définition a été formalisée dans
le glossaire du Comité National des systèmes de sécurité (CNSSI) \cite{cnssi_4009}.

\paragraph{}
Les architectures MLS ne se limitent pas à la problématique de contrôle des
communications dans un environnement multi-niveaux de sécurité sur du matériel
partagé. Elles permettent également la communication au travers d'une
infrastructure compatible MLS. Dans \cite{milssecgrid}, les auteurs
décrivent les mécanismes répartis dans le réseau d'interconnexion permettant
de faire communiquer des domaines de sécurité hétérogènes de manière sûre. Les
quatre propriétés des systèmes MLS sont alors respectées.



\subsection{MLS et principe de virtualisation}

\paragraph{}
Le principe de MultiLevel Security s'appuie sur un environnement d'exécution
de confiance assurant le cloisonnement des compartiments de domaines de
sécurité différents. Cet environnement d'exécution est appellé un {\it
Separation Kernel}. Le principe de Separation Kernel a été initialement
défini en 1981 \cite{sk_def} et reste aujourd'hui d'actualité, au travers d'un
grand nombre de travaux tant universitaires qu'industriels \cite{alves2006mils,boettcher2008mils}

\paragraph{}
Parmi les mécanismes de séparation des domaines tels que décrits par la NSA
dans la définition des architectures MILS, le Separation Kernel est
aujourd'hui la solution la plus implémentée 
\cite{greve2003separation,heitmeyer2006formal,white2004separation}. Les systèmes MILS et MLS requièrent, en plus des
différentes fonctions de sécurité dont le nombre et la complexité dépendent du
niveau de certification demandé, une compatibilité avec les quatre propriétés
\ref{pro:noncontournable}, \ref{pro:evaluable}, \ref{pro:validation} et
\ref{pro:inviolable}.

\paragraph{}
La réponse au besoin de MultiLevel Security et de Multi-Independent Level of
Security via l'usage d'un Separation Kernel permet de construire une
architecture logicielle où se côtoient des compartiments hébergeant des
fonctions logicielles plus ou moins complexes. Ces fonctions logicielles
peuvent correspondre à des systèmes d'exploitation complets, lorsqu'il est
nécessaire de déployer des services complexes comme les services réseaux IP.
Le Separation Kernel se comporte alors comme un hyperviseur avec des
propriétés de sécurité particulières. C'est sur cette base que je m'appuie
dans le cadre de ma thèse comme base de l'architecture logicielle.
Afin de pouvoir sélectionner le bon candidat pour un Separation Kernel, j'ai
étudié les solutions existantes de virtualisation et les fonctions de sécurité
qu'elles supportent.

\paragraph{}
Afin d'assurer le cloisonnement de ces services complexes, considérés comme
n'étant pas de confiance, le Separation Kernel doit également être apte à
héberger dans certains compartiments des moniteurs de sécurité certifiables.
Ceux-ci sont donc de petite taille, sous forme d'une fonction simple
s'exécutant directement au-dessus du Separation Kernel. Cependant, ces
fonctions doivent pouvoir être dissociées du Separation Kernel en terme de
binaires, ceci afin de limiter la complexité de chaque brique logicielle, et
pour pouvoir être potentiellement compatible avec le principe de certification
par composition.

\section{Interconnexion sécurisée inter-domaines de sécurité}

\subsection{Le contrôle de flux et les passerelles de sécurité}

\paragraph{}
Des travaux ont été effectués \cite{blum2011smart}\cite{bettger2009secure} pour répondre au besoin d'interconnexion de serveurs
hébergeant des données dont le niveau de sensibilité et les profils
utilisateurs associés sont variables. Ces travaux ciblent la problématique de
l'usage du SOA (Service Oriented Architectures) pour les données
potentiellement confidentielles \cite{blum2011smart} ou une fonction de
stockage de type base de données compatible MILS \cite{bettger2009secure}. Ces travaux décrivent principalement la
gestion des rôles et des attributs par les services, et comment faire
interagir ces derniers avec  des éléments logiciels de  vérification des rôles
et les gestionnaires de stockage.
Ces travaux prennent cependant comme hypothèse que l'environnement
d'exécution est de confiance, travaillant sur une formalisation de
l'architecture applicative et les protocoles de communication utilisés.

\section{Synthèse}

\paragraph{}
Aujourd'hui, les solutions permettant d'interconnecter plusieurs domaines de
sécurité s'appuient sur une séparation matérielle stricte, impliquant
plusieurs équipements \cite{sstic2006diode}\cite{tsf101}. Plus globalement,
les solutions d'interconnexion de domaines de sécurité ne sont pas conçus pour
la modularité, le temps réel ou encore l'embarqué contraint. En effet, ces
besoins sont plus récents, conséquence des exigences avioniques et
vétroniques, pour lesquelles les produits de sécurité ne sont pas encore
définis.\\
Dans le cadre de ma thèse, je cherche à déterminer une solution
logicielle afin de répondre aux besoins systroniques, en m'inspirant
des solutions existantes qui ont su démontrer leur capacité à répondre aux
exigences sécuritaires. Je cherche donc à définir une solution complète
compatible avec les exigences des architectures MLS et dans le même temps
fournissant suffisament de compléments logiciels pour répondre aux contraintes
de la problématiques générale. Je dois donc tout d'abord sélectionner le bon Separation
Kernel. Ce choix s'appuit sur un état de l'art des différentes solutions de
compartimentation et de virtualisation, décrites dans le Chapitre suivant.
