%%
%%
%% hardware_impacts.tex for thesis in /doctorat/these/tex
%%
%% Made by Philippe THIERRY
%% Login   <Philippe THIERRYreseau-libre.net>
%%
%% Started on  Fri Mar 12 16:36:41 2010 Philippe THIERRY
%% Last update Mon Aug 30 17:00:21 2010 Philippe THIERRY

\chapter{La sécurisation d'une plateforme de traitement réseau multi-domaines de sécurité}
\doMinitoc

\paragraph{}
{\it Il existe un certain nombre de solutions dont le but est de permettre
l'interconnexion de domaines de sécurité hétérogènes. Ces solutions répondent
plutôt à des besoins de type SI, mais les principes que ces solutions
utilisent restent un très bon point de départ dans le cadre de la définition
d'une architecture logicielle sécurisée.}

\section{Sécurisation par séparation physique des traitements}

\subsection{Interconnexion sécurisé par passerelle de type diode matérielle}
\label{sec:diodemat}

\subsubsection{Description de la solution}

\paragraph{}
Dans les systèmes militaires, les domaines de sécurité devant être
interconnectés le sont au travers de passerelles certifiées s'appuyant sur des
éléments physiques disjoints. Ces dernier assurent un transfert sens unique de données
entre le domaine de plus basse sécurité (source des données) et le domaine de
plus haute sécurité (destination des données). Le but de la passerelle de
sécurité est double:
\begin{itemize}
  \item Elle assure la traversée sens unique. Aucune donnée du domaine de
    sécurité le plus élevé peut être transféré vers le domaine de sécurité le
    plus bas
  \item Elle assure une opacité forte du domaine de sécurité le plus élevé d'un point de vue
    comportemental. Elle évite ainsi les canaux cachés s'appuyant sur l'étude
    du comportement du domaine de sécurité le plus élevé. Ces derniers
    permettent en effet de remonter indirectement des données auprès du
    domaine de sécurité le plus bas.
\end{itemize}

\begin{figure}
  \label{fig:diodephy}
  \input{figures/diode_phy.tex}
  \caption{Architecture générale d'une passerelle de type diode matérielle}
\end{figure}

\paragraph{}
Le principe d'architecture d'une diode matérielle a été formalisé par Philippe
Lagadec de la Direction Générale de l'Armement en 2006 \cite{sstic2006diode}. Le principe
proposé s'appuie sur un élément matériel aux propriétés physiques
particulières assurant une traversée sens unique, associée à deux {\it
  guichets}, comme décrit dans la Figure \ref{fig:diodephy}. Ces guichets
permettent une action humaine pour initier le transfer de données et le
receptionner. Une telle architecture permet de garantir l'imputabilité du
transfert de donnée en cas d'usage invalide de la passerelle.

\subsubsection{Avantages et limitations}

\paragraph{}
Les diodes matérielles s'appuie sur le principe de séparation protocolaire
pour limiter l'exploitation de canal caché s'appuyant sur l'utilisation des
en-têtes protocolaires comme conteneur d'information.\\
En conséquence, elles ne permettent donc pas d'intégrer le support d'une
criticité multiple en terme d'ordonnancement de flux. Cette gestion doit donc
être déportée au niveau du guichet haut (émetteur de la donnée).L'intervention
humaine, conséquence du besoin d'imputabilité associé au transfert de donnée,
est également problématique lorsque le besoin de temps réel est exigé.
Comme le décrit l'auteur, la diode matérielle permet cependant d'assurer à la fois:
\begin{itemize}
\item la confidentialité des données du récepteur
\item l'intégrité et la disponibilité des données de l'émetteur
\end{itemize}

\subsection{Firewall d'interconnexion de domaines de sécurité hétérogènes}

\paragraph{}
Il existe peu de solutions permettant une interconnexion de domaines de
sécurité disjoint. C'est le cas de la solution TSF 101\cite{tsf101} de Thales
Security, permettant de faire transiter des données entre domaines de sécurité
disjoints en fonction d'une politique de sécurité chargée dans l'appliance.

\subsubsection{Description de la solution}

\paragraph{}
La solution TSF 101 permet de faire transiter des données déclassifiée du
domaine de sécurité le plus haut au domaine de sécurité le plus bas. Pour
cela, il s'appuie sur un critère de filtrage prédéfinit et non modifiable
dans le cadre de son utilisation. La solution est certifié par les critères
communs au niveau EAL 5.

\subsubsection{Avantages et limitations}

\paragraph{}
La solution permet d'interconnecter des réseaux de niveau de sensibilité
différentes. Il s'agit d'une appliance, impliquant un facteur de forme et des
propriétés d'architecture ne lui permettant pas d'être intégré dans des
environnements embarqués contraints. La solution ne cible pas non plus de
propriétés temps réelles, et n'est pas modulaire en terme de services
logiciels, le besoin auquel cette appliance répond ne nécessitant pas ces
propriétés.

\section{A propos des architecture MLS (MultiLevel Security) et MILS
(Multi-Independent Level of Security)}
\label{sec:mils}

\subsection{Systèmes MILS et la haute sécurité}

\paragraph{}
Un système MILS (Multiple Independent Level of Security) est une architecture
de haute sécurité basée sur le principe de séparation des flux d'informations
dont l'implémentation est faite dans un composant certifié. Ce dernier assure
le cloisonnement de ces flux via un mécanisme évaluable.

\paragraph{}
Le mécanisme assurant le cloisonnement des différent niveaux de sécurité n'est
pas imposé. Il peut être physique (séparation complète), matériel
(implémentation d'un mécanisme matériel) ou logiciel (noyau de séparation
sécurisé, usuellement nommé {\it Secure Separation Kernel} ou SSK. Dans le
cadre de ma thèse, la solution considérée est le SSK afin d'être compatible
avec les exigences de volume, de consommation et de faible coût.

\paragraph{}
Avant les premiers travaux sur les systèmes MILS (définis par le DoD au début
des année 2000), la problématique de gestion de la
sécurité dans les systèmes automatisés était étudiée au travers de principes
de listes de contrôle d'accès. En 1973\cite{lapadula1}, une méthode de
gestion de contrôle d'accès définissant le principe de de sujets ayant accès à
des objets fut définit et démontrée mathématiquement. Il s'agit du RBAC
\cite{ferraiolo1995role}.

\paragraph{}
En parallèle des travaux de Bell et LaPadula\cite{labadula1}\cite{lapadula2},
une étude fut effectués sur la capacité à verifier formellement les architectures
logicielles de sécurité basées sur un noyau\cite{securedesign} ({\it" kernelized secure
systems"}), où l'auteur démontre la difficulté de certifier un système où
le noyau lui même est trop complexe. L'auteur décrit alors le principe de
noyau de sécurité, devant être de petite taille, et pouvant être accompagné de
processus logiciels dis de confiance, également certifiable. Une telle
architecture permet alors d'héberger également des processus non certifiables
dont le cloisonnement et assuré par le noyau. L'auteur décrit également que le
noyau n'est alors plus sujet d'une politique de sécurité, cette dernière
ciblant les processus logiciel qu'il porte. Plus globalement, l'auteur décrit
les premiers principes d'un système dit {\it rouge-noir}, dans lequel une
architecture distribuées de sous-systèmes communiquent de manière sécurisée en
assurant que l'unique moyen de passage est maîtrisé par un élément de
confiance permettant la transmission de données noircie. Ce principe est
encore utilisé aujourd'hui dans la définition de systèmes dont l'architecture
est distribuée comme la radio logicielle\cite{sdr}, où il s'associe à une
architecture de type MILS pour séparer rouge et noir.

\paragraph{}
La définition des architectures MILS reprend ces travaux afin de définir une
nouvelle approche contrastant fortement avec les principes décrit par Bell et
LaPadula.\\
Les systèmes MILS sont compatibles de quatre propriétés éditées par le DoD:

\begin{property}
\label{pro:noncontournable}
{\bf Non contournable}:
Un composant ne peux utiliser que le chemin de communication
qui lui est fournit par le moniteur de sécurité.
\end{property}

\begin{property}
\label{pro:evaluable}
{\bf Evaluable}:
L'ensemble des composant considérés comme de confiance doivent être évaluable
au niveau nécessaire pour atteindre le niveau de sécurité demandé.
\end{property}

L'évaluation de ses composant doit être suffisante pour assurer le niveau de
sécurité de l'ensemble du système (i.e. les composants n'étant pas de
confiance ne doivent pas impacter le niveau de sécurité du système.

\begin{property}
\label{pro:validation}
{\bf Validation à chaque accès}:
Chaque accès ou message entre composant doit pouvoir être validé par un
moniteur de sécurité.
\end{property}

Le moniteur de sécurité peut être le SSK ou un processus de confiance dédié à
ce traitement.

\begin{property}
\label{pro:inviolable}
{\bf Inviolable}:
Le système assure le contrôle des accès en écriture aux moniteurs de
sécurités, à leurs données ou à leur configuration, assurant ainsi leur
intégrité et celle du système.
\end{property}

\paragraph{}
Les architectures MILS ne se limitent pas à la problématique de contrôle des
communications dans un environnement multi-niveaux de sécurité sur du matériel
partagé. Elles permettent également la communication au travers d'une
infrastructure compatible MILS\cite{milssecgrid}. Dans cet article, les auteurs
décrivent les mécanismes répartis dans le réseau d'interconnexion permettant
de faire communiquer des domaines de sécurité hétérogène de manière sûre. Les
quatre propriétés des systèmes MILS sont alors respectées.

\subsection{Principes généraux du MLS}

\paragraph{}
Un système MultiLevel Security correspond à l'usage d'un système informatique
permettant de traiter en parallèle des données de niveaux de sécurité hétérogènes. Il
permet l'accès simultané à des utilisateurs ayant des niveaux d'accréditation
et de besoin-d'en-connaître différents, tout en garantissant un cloisonnement
strict entre ces différents utilisateurs. La définition a été formalisé dans
le glossaire du commité National des systèmes de sécurité (CNSSI)\cite{cnssi_4009}.

\subsection{MLS et principe de virtualisation}

\paragraph{}
Le principe de MultiLevel Security s'appuie sur un environnement d'exécution
de confiance assurant le cloisonnement des compartiments de domaine de
sécurité différents. Cet environnement d'exécution est appellé un {\it
Separation Kernel}. Le principe de separation kernel a été initialement
définit en 1981\cite{sk_def} et reste aujourd'hui d'actualité, au travers d'un
grand nombre de travaux tant universitaires qu'industriels\cite{alves2006mils,boettcher2008mils}

\paragraph{}
Parmi les mécanismes de séparation des domaines tels que décrit par la NSA
dans la définition des architectures MILS, le Separation Kernel est la
solution la plus tengible dans l'existant et les travaux de recherche
\cite{greve2003separation,heitmeyer2006formal,white2004separation}. Les systèmes MILS et MLS requièrent, en plus des
différentes fonctions de sécurité dont le nombre et la complexité dépendent du
niveau de certification demandé, une compatibilité avec les quatre propriétés
\ref{pro:noncontournable}, \ref{pro:evaluable}, \ref{pro:validation} et
\ref{pro:inviolable}.

\paragraph{}
La réponse au besoin de MultiLevel Security et de Multi-Independent Level of
Security via l'usage d'un separation kernel permet de construire une
architecture logicielle où se cotoient des compartiment hébergeant des
fonctions logicielles plus ou moins complexes. Ces fonctions logicielles
peuvent correspondre à des systèmes d'exploitation complet, lorsqu'il est
nécessaire de déployer des services complexes comme les services réseaux IP.
Le separation kernel se comporte alors comme un hyperviseurs avec des
propriétés de sécurité particulières. Il devient donc nécessaire d'étudier
l'existant des solutions de virtualisations et les fonctions de sécurité
qu'elles supportent.

\paragraph{}
Afin d'assurer le cloisonnement de ces services complexes, considérés comme
n'étant pas de confiance, le Separation Kernel doit également être apte à
héberger dans certains compartiments des moniteurs de sécurité certifiables.
Ces derniers sont donc de petite taille, sous forme d'une fonction simple
s'exécutant directement au dessus du Separation Kernel. Cependant, ces
fonctions doivent pouvoir être dissociées du Separation Kernel en terme de
binaires, ceci afin de limiter la complexité de chaque brique logicielle, et
pour pouvoir être potentiellement compatible avec le principe de certification
par composition. Ce principe permet de pouvoir faire évoluer l'architecture
logicielle sans devoir certifier à nouveau les éléments binaires que le sont
déjà sur la cible matérielle utilisée.

\section{Interconnexion sécurisée inter-domaines de sécurité}

\subsection{Le contrôle de flux et les passerelles de sécurité}

\paragraph{}
Des travaux ont été effectués\cite{blum2011smart}\cite{bettger2009secure} pour répondre au besoin d'interconnexions de serveurs
hébergeant des données dont le niveau de sensibilité et les profils
utilisateurs associés sont variant. Ces travaux ciblent la problématique de
l'usage du SOA (Service Oriented Architectures) pour les données
potentiellement confidentielles\cite{blum2011smart} ou une fonction de
stockage de type base de données compatible MILS\cite{bettger2009secure}. Ces travaux décrivent principalement la
gestion des rôles et des attributs par les services, et comment faire
interagir ses derniers avec  des éléments logiciels de  vérification des rôles
et les gestionnaires de stockage.
Ces travaux considèrent cependant comme hypothèse que l'environnement
d'exécution est de confiance, travaillant sur une formalisation de
l'architecture applicative et le protocole de communication entre ces
dernières.

\section{Synthèse}

\paragraph{}
Aujourd'hui, les solutions permettant d'interconnecter plusieurs domaines de
sécurité s'appuient sur une séparation matérielle stricte, impliquant
plusieurs équipements \cite{sstic2006diode}\cite{tsf101}. Plus globalement,
les solutions d'interconnexion de domaines de sécurité ne sont pas conçu pour
la modularité, le temps réel ou encore l'embarqué contraint. En effet, ces
besoins sont plus récents, dérivant des nouvelles exigences avioniques et
vétroniques, pour lesquels les produits de sécurité ne sont pas encore
définis. Dans le cadre de ma thèse, je cherche à déterminer une solution
logicielle afin de répondre à ces besoins, en m'inspirant dans le même temps
des solution existantes qui ont su démontrer leur capacités à répondre aux
exigences sécuritaires.
